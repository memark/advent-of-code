# https://adventofcode.com/2024/day/6

# uiua v0.14.0-dev.7
# Experimental!

G‚Äº! ‚Üê |3 (
  $delta^1
  $new‚ä∏+
  # ‚®¨(+100?|‚àò) ?‚ÇÇ-:1/+‚ä∏<‚ÇÄ
  ‚®¨(‚àò?|‚àò) ?‚ÇÇ-:1/+‚ä∏<‚ÇÄ
  # ‚ç§"oob"
  ‚ó°ùÑê‚ä°?‚ÇÉ
  $coll‚à®‚äÉ(=@#|=@O)
  ‚®¨(         # no collision
    ‚äô‚çú‚ä°(@X‚óå) # - mark visited
    ‚çú‚ä°(^0‚óå)  # - set new pos
  |          # collision
    ‚äô‚çú‚ä°(^2‚óå) # - turn
    ‚óå        # - discard new pos
  )
)

F ‚Üê |1 (
  $matrix
  $curr‚ô≠‚ä∏(‚äö‚àà"><^v")
  $char‚ó°‚ä°
  ‚ç£(¬∞$"^"
    ‚ç©(G‚Äº!@^[¬Ø1 0]@>)
  | ¬∞$">"
    ‚ç©(G‚Äº!@>[0 1]@v)
  | ¬∞$"v"
    ‚ç©(G‚Äº!@v[1 0]@<)
  | ¬∞$"<"
    ‚ç©(G‚Äº!@<[0 ¬Ø1]@^)
  )
)

üî¢ ‚Üê /+‚ô≠‚àà"X><^v"
üê™ ‚Üê üî¢ ‚ç•(‚ç£F)‚àû

‚îå‚îÄ‚ï¥test
  # ‚ç§‚§ô‚âç 41 üê™ ‚â°¬∞‚ñ° ¬∞/$"_\n_" &fras$ example.txt
  # ‚ç§‚§ô‚âç 5067 üê™ ‚â°¬∞‚ñ° ‚Üò¬Ø1 ¬∞/$"_\n_" &fras$ input.txt
‚îî‚îÄ‚ï¥

Prep ‚Üê ‚â°¬∞‚ñ° ¬∞/$"_\n_" &fras

TryVariant ‚Üê (
  map [] []
  ‚ç•(‚çú:(
      ‚üúinsert:1
      ‚ç£(F              # matrix ? matrix
      | ‚äô(map [] [] ‚óå) # matrix map ? matrix map
      )
      # ‚äô(&s.)
      # &s.
      # &sl0.02
    )
  )‚àû
  ‚ßª
)

# TryVariant Prep "example_1.txt"
# TryVariant Prep "example_2a.txt"
# TryVariant Prep "example_2b.txt"
# TryVariant Prep "example_2c.txt"

# n√§r en runda terminerat, antingen pga exception eller termination,
# kolla efter < m fl f√∂r att avg√∂ra om det var loop eller ej

# F ger matrix map
# jag v√§nder p√• detta f√∂r att kunna avsluta ‚ç£

# Nu har jag en funktion som ger map matrix.
# Om den kraschat (k√∂rt utanf√∂r) √§r len map = 0.
# Annars har den ett st√∂rre v√§rde.

# Sedan iterera √∂ver alla . och prova att ers√§tta dem med O

Prep "example_1.txt"
‚äö‚ä∏‚åï@.
‚äô¬§
‚â°‚çú‚ä°(@O‚óå)
‚â°TryVariant
‚ñΩ>0
# /+>‚ÇÄ

# Ibland kraschar det p√• 10_7, ibland f√•ngas det som det ska. f√∂rst√•r inte varf√∂r!!

# √Ñh, det √§r ju √§nd√• en kass l√∂sning. Jag borde g√∂ra en som anv√§nder Do ist√§llet.
# Funktionen jag itererar med beh√∂ver returnera
# - mapen (s√• jag kan kolla efter loop)
# - om det var OOB
# alternativt bryta upp i tv√• funktioner d√§r jag kan kolla OOB innan jag ens f√∂rs√∂ker flytta
