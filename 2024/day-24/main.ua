# https://adventofcode.com/2024/day/24

# uiua v0.15.0-dev.1
# Experimental!

# a XOR b = (a OR b) - (a AND b)
ğŸ™… â† Â°â‹¯-â¬š0âŠƒÃ—âˆ¨âˆ©â‹¯
â”Œâ”€â•´ğŸ§ª
  â¤â¤™â‰ 7 ğŸ™… 4 3
  â¤â¤™â‰ 12 ğŸ™… 10 6
  â¤â¤™â‰ 0 ğŸ™… 1 1
â””â”€â•´

ğŸ—„ â† âŠƒ(
  $state map â‰¡âŠ“Â°â–¡â—‡â‹• Â°âŠŸâ‰ â‰¡â†˜â‚regex"(...): (.+)"
| $gates map â‰¡âŠƒâŠ£(âŠ0_2_1) âˆµÂ°â–¡ â‰¡â†˜â‚regex"(...) (AND|OR |XOR) (...) -> (...)" âœâŠœâˆ˜â‰¡â‹…" OR "âŠ¸â¦·" OR"
)

GetKeys â† âŠ™â—ŒÂ°map

# bool ? gateKey state
StateHasKey â† â‰âŠ™GetKeys

# bool ? gateKey state gates
StateHasGateKeyInputs â† /Ã—â‰¡âŒŸhas â†™â‚‚ğ„âŒŸget

# bit ? gateKey state gates
RunGate â† (
  âŠƒ(âŠ¡â‚‹â‚|â‰¡âŒŸgetâ†™â‚‚)ğ„âŒŸget
  â¨¬(/Ã—|/ğŸ™…|/âˆ¨) âŠ—â–¡:{"AND" "XOR" "OR "}
)

# state gates ? state gates
Iterate â† (
  GetKeys,
  âœâŠ™Â¤(â–½Â¬â—¡â‰¡StateHasKey)
  âœâŠ™âˆ©Â¤(â–½â—¡â‰¡StateHasGateKeyInputs)
  â—¡âœâŠ™âˆ©Â¤â‰¡RunGate
  âˆ§insert:
)

# zs ? state
ğŸ’¤ â† getâ† â–½â‰¡âŠ¸(=@zâŠ¢) âŠ¸GetKeys

ğŸª â† Â°â‹¯ğŸ’¤ âŠ™â—Œ â¥Iterateâˆ ğŸ—„

â”Œâ”€â•´ğŸ§ª
  â¤â¤™â‰ 4 ğŸª &fras"example_1a.txt"
  â¤â¤™â‰ 2024 ğŸª &fras"example_1b.txt"
  â¤â¤™â‰ 59619940979346 ğŸª &fras"input.txt"
â””â”€â•´
