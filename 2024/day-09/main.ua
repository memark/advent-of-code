# https://adventofcode.com/2024/day/9

# uiua v0.14.0-dev.7
# Experimental!

Intersperse â† â†˜â‚â™­â‰¡âŠ‚

# array ? old new array
Replace â† âœâ–½â‹…âˆ˜=, âŠ™:
â”Œâ”€â•´ğŸ§ª
  â¤â¤™â‰ 1_3_8_3_2 Replace 5 3 [1 5 8 5 2]
â””â”€â•´

# TODO: neg1 blir alltid Â¯ 1 (med mellanslag)
# TODO: Bryt ut en riktig ReplaceSubstring hÃ¤r. Dags fÃ¶r Ã¥rets lib.ua nu.

# ? array
Format â† âœâŠœâˆ˜â‰¡â‹…"." âŠ¸â¦· "-1" /â—‡âŠ‚â‰¡(â–¡Â°â‹•)
Print  â† &p Format

IteratePartOne â† (
  âŠ¸âŠƒ((âŠ£âŠšâ‰ Â¯1)|(âŠ¢âŠš=Â¯1))
  â¨¬(â—Œâ—Œ|âœâŠâ‡ŒâŠ‚)â—¡<
)

Checksum â† /+Ã—â‡¡âŠ¸â§» â–½âŠ¸â‰ Â¯1

ğŸª â† (
  â‰¡â‹• â–½âŠ¸â‰ @\n
  â–½: IntersperseÂ¯1 â‡¡âŠ¸(âŒˆÃ·â‚‚â§»)
  â¥IteratePartOneâˆ
  Checksum
)
â”Œâ”€â•´ğŸ§ª
  â¤â¤™â‰ 1928 ğŸª &fras"example.txt"
  â¤â¤™â‰ 6386640365805 ğŸª &fras"input.txt"
â””â”€â•´

# map ? id map
TryCompact â† (
  âŠƒ(âŠ™: -1=Â¯1â‡¡ âŠ¸â§» âŠšâŠ¸âŒ•
    âŠš>â‚€âŠ¸â¦·
    â¬šÂ¯1â†™â§»:âŠ™:
    $freeSpaceIds
  | $idsToMove âŠšâŒ• âŠ™âˆ˜
  )
  âŠ™:
  â—¡âŠƒ(
    (/Ã—<)  # Â¯1 means wrong order
  | (=Â¯1âŠ¢) # Â¯1 means not enough space
  )
  âˆ¨ # one Â¯1 is enough to abort
  â¨¬(âœâŠâ‡Œ âŠ‚|â—Œâ—Œ)
)

ğŸ« â† (
  â‰¡â‹• â–½âŠ¸â‰ @\n
  â–½: IntersperseÂ¯1 â‡¡âŠ¸(âŒˆÃ·â‚‚â§»)
  $fileIds â‡Œâ†â—´âŠ¸â–½âŠ¸â‰ Â¯1
  âˆ§TryCompact
  â‡¡âŠ¸â§»
  âˆ©â–½,âŠ™(âŠ¸â‰ Â¯1)
  /+Ã—
)
â”Œâ”€â•´test
  â¤â¤™â‰ 2858 ğŸ« &fras"example.txt"
  â¤â¤™â‰ 6423258376982 ğŸ« &fras"input.txt"
â””â”€â•´
